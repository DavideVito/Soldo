(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{123:function(e,t,n){},124:function(e,t,n){},140:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),c=n(34),o=n.n(c),a=(n(123),n(124),n(182)),s=n(103),l=n(193),d=n(204),j=n(191),u=n(190),b=n(33),O=n(16),f=n.n(O),x=n(43),h=n(24),p=n(7),m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="https://soldo.davidevitiello.dev"+e;return window.location.href.includes("localhost")&&(n="http://localhost:3001"+e),fetch(n,t)},v=n(194),g=n(2),y=function(){var e=Object(b.b)().loginWithRedirect;return Object(g.jsx)(u.a,{variant:"contained",onClick:function(){return e()},children:"Log In"})},w=Object(i.createContext)(),C=function(e){var t=Object(i.useState)(null),n=Object(p.a)(t,2),r=n[0],c=n[1],o=Object(b.b)(),a=o.user,s=o.isLoading,l=o.error,d=Object(i.useCallback)(Object(h.a)(f.a.mark((function e(){var t,n,i,r,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=encodeURIComponent(a.email),e.next=3,m("/login/utente/"+t);case 3:return n=e.sent,e.next=6,n.json();case 6:i=e.sent,r=Object(x.a)({},a),o=i,c(Object(x.a)(Object(x.a)({},r),o));case 10:case"end":return e.stop()}}),e)}))),[a]);return Object(i.useEffect)((function(){if(!a)return c(null);d()}),[a,d]),Object(i.useEffect)((function(){console.log(l)}),[l]),l?Object(g.jsx)("pre",{children:JSON.stringify(l)}):r?Object(g.jsx)(w.Provider,{value:r,children:e.children}):Object(g.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",marginTop:"25px"},children:[s&&Object(g.jsx)(v.a,{}),Object(g.jsx)(y,{})]})},k=function(){var e=Object(b.b)(),t=e.logout,n=e.isAuthenticated,r=e.isLoading,c=Object(i.useContext)(w);return Object(i.useEffect)((function(){n&&m("/login/utente",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nome:c.family_name+" "+c.given_name,email:c.email})})}),[n,c.family_name,c.email,c.given_name]),r?Object(g.jsx)("div",{children:"Loading ..."}):n&&Object(g.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",marginTop:"25px"},children:Object(g.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(g.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:Object(g.jsx)(j.a,{src:c.picture})}),Object(g.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:Object(g.jsx)("h2",{children:c.name})}),Object(g.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:Object(g.jsx)("p",{children:c.email})}),Object(g.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",marginBottom:"20px"},children:Object(g.jsx)(u.a,{variant:"contained",onClick:function(){t({returnTo:window.location.origin})},children:"Logout"})})]})})},S=Object(i.createContext)(),T=function(e){var t=Object(i.useState)([]),n=Object(p.a)(t,2),r=n[0],c=n[1],o=function(){var e=Object(h.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("/prodotti/");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,c(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){o()}),[]),Object(g.jsx)(S.Provider,{value:r,children:e.children})},P=n(197),E=n(192),D=n(200),L=n(201),W=n(202),A=n(203),F=n(184),U=n(198),B=n(102),I=n.n(B),N=n(104),z=n(189),J=n(195),R=n(186),M=n(83),_=i.forwardRef((function(e,t){var n=e.in,i=e.children,r=e.onEnter,c=e.onExited,o=Object(N.a)(e,["in","children","onEnter","onExited"]),a=Object(M.useSpring)({from:{opacity:0},to:{opacity:n?1:0},onStart:function(){n&&r&&r()},onRest:function(){!n&&c&&c()}});return Object(g.jsx)(M.animated.div,Object(x.a)(Object(x.a)({},o),{},{style:a,children:i}))})),H={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:"70vw",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function q(e){var t=e.children,n=e.bottone,r=void 0===n?{text:"Open Modal",callback:function(){},style:{}}:n,c=i.useState(!1),o=Object(p.a)(c,2),a=o[0],s=o[1];return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("div",{children:Object(g.jsx)("div",{style:r.style,children:Object(g.jsx)(u.a,{variant:"contained",onClick:function(){r.callback&&r.callback(),s(!0)},children:r.text})})}),Object(g.jsx)(R.a,{"aria-labelledby":"spring-modal-title","aria-describedby":"spring-modal-description",open:a,onClose:function(){return s(!1)},closeAfterTransition:!0,BackdropComponent:z.a,BackdropProps:{timeout:500},children:Object(g.jsx)(_,{in:a,children:Object(g.jsx)(J.a,{sx:H,children:t})})})]})}var K=n(15),Q=n(188),Z=n(180),$=n(187),G=n(196),V=n(101),X=n.n(V),Y=n(100),ee=n.n(Y),te=function(e){var t=e.prodotto,n=e.add,r=e.aggiungiProdotto,c=e.rimuoviProdotto,o=Object(i.useState)(0),a=Object(p.a)(o,2),s=a[0],l=a[1];return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)($.a,{children:Object(g.jsx)(G.a,{primary:t.nome,secondary:t.prezzoUnitario})},t.id),n&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(u.a,{variant:"contained",onClick:function(){c(t),s<=0||l(s-1)},children:Object(g.jsx)(ee.a,{})}),Object(g.jsx)(P.a,{variant:"body2",display:"inline",margin:"15px",children:s}),Object(g.jsx)(u.a,{variant:"contained",onClick:function(){s>=10||(r(t),l(s+1))},children:Object(g.jsx)(X.a,{})})]})]})},ne=Object(i.createContext)(),ie=function(e){var t=e.children,n=Object(i.useContext)(w),r=Object(i.useState)([]),c=Object(p.a)(r,2),o=c[0],a=c[1],s=Object(i.useCallback)(Object(h.a)(f.a.mark((function e(){var t,i,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=encodeURIComponent(n.email),e.next=3,m("/ordini/".concat(t));case 3:return i=e.sent,e.next=6,i.json();case 6:r=e.sent,a(r);case 8:case"end":return e.stop()}}),e)}))),[n.email]);return Object(i.useEffect)((function(){s()}),[s]),Object(g.jsx)(ne.Provider,{value:[o,s],children:t})},re=new Intl.NumberFormat(navigator.language,{style:"currency",currency:"EUR"}),ce=function(){var e=Object(i.useContext)(ne)[1],t=Object(i.useContext)(S),n=Object(b.b)().user,r=Object(i.useState)(null),c=Object(p.a)(r,2),o=c[0],a=c[1],s=Object(i.useState)([]),l=Object(p.a)(s,2),d=l[0],j=l[1],O=function(e){j([].concat(Object(K.a)(d),[e]))},x=function(e){var t=d.includes(e);d.splice(t,1);var n=Object(K.a)(d);j(n)},v=function(){var t=Object(h.a)(f.a.mark((function t(){var i,r,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i={email:n.email,prodotti:d},r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)},c=setTimeout((function(){m("/ordini",r).then(e),y()}),3e3),a(c);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),y=function(){clearTimeout(o),a(null)},w=Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(u.a,{color:"secondary",size:"small",onClick:y,children:"UNDO"}),Object(g.jsx)(U.a,{size:"small","aria-label":"close",color:"inherit",onClick:y,children:Object(g.jsx)(Z.a,{fontSize:"small"})})]});return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(Q.a,{open:null!=o,autoHideDuration:3e3,onClose:a,message:"L'ordine verr\xe0 caricato tra 3 secondi",action:w}),Object(g.jsx)(E.a,{container:!0,spacing:2,children:t.map((function(e){return Object(g.jsx)(E.a,{item:!0,lg:4,children:Object(g.jsx)(te,{prodotto:e,add:!0,aggiungiProdotto:O,rimuoviProdotto:x})})}))}),Object(g.jsxs)(E.a,{style:{marginTop:".1rem"},container:!0,spacing:2,direction:"row",justifyContent:"center",alignItems:"center",children:[Object(g.jsx)(E.a,{item:!0,sm:12,style:{verticalAlign:"middle"},direction:"row",justifyContent:"center",alignItems:"center",children:Object(g.jsxs)(P.a,{children:["Totale:"," ",re.format(d.reduce((function(e,t){return e+t.prezzoUnitario}),0))]})}),Object(g.jsx)(E.a,{item:!0,sm:12,children:Object(g.jsx)(u.a,{variant:"contained",onClick:v,children:"Aggiungi ordine"})})]})]})},oe=function(){return Object(g.jsx)(E.a,{container:!0,spacing:{xs:3,md:3},style:{margin:"1px"},children:Object(g.jsx)(ce,{})})},ae=n(44),se=function(e){var t=e.ordini,n=e.user,i=e.marcaOrdineCompletato;return Object(g.jsx)(E.a,{container:!0,spacing:{xs:1,md:3},children:t.map((function(e){return Object(g.jsx)(E.a,{item:!0,xs:12,sm:6,md:3,children:Object(g.jsxs)(D.a,{children:[Object(g.jsx)(L.a,{avatar:Object(g.jsx)(j.a,{sx:{bgcolor:ae.a[500]},"aria-label":"recipe",children:e.idOrdine}),title:e.nome,subheader:"Data: "+new Date(e.data).toLocaleString(navigator.language)}),Object(g.jsx)(W.a,{children:Object(g.jsx)(E.a,{container:!0,spacing:{xs:3,md:3},style:{margin:"1px"},children:e.dettagli.map((function(e){return Object(g.jsxs)(E.a,{item:!0,children:[Object(g.jsxs)(P.a,{variant:"body1",children:["\u2022 ",e.nomeProdotto]}),Object(g.jsxs)(P.a,{variant:"body2",children:[e.tipoProdotto," ",e.QTA]})]},e.nomeProdotto)}))})}),n.admin?Object(g.jsx)(A.a,{disableSpacing:!0,children:Object(g.jsx)(F.a,{title:"Marca come completato",children:Object(g.jsx)(U.a,{"aria-label":"Marca come completato",onClick:function(){i(e.idOrdine)},children:Object(g.jsx)(I.a,{})})})}):""]})},e.idOrdine)}))})},le=function(){var e=Object(i.useContext)(ne),t=Object(p.a)(e,2),n=t[0],r=t[1],c=Object(i.useContext)(w),o=function(){var e=Object(h.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("/ordini/completato",{body:JSON.stringify({idOrdine:t}),headers:{"Content-Type":"application/json"},method:"POST"});case 2:e.sent.ok||alert("Error"),r();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{style:{margin:"0px .5rem",marginBottom:"100px"},children:[Object(g.jsx)(q,{bottone:{text:"Crea nuovo ordine",style:{display:"flex",justifyContent:"center"}},children:Object(g.jsx)(oe,{})}),Object(g.jsx)("div",{style:{marginTop:"1.5rem",marginBottom:"1rem"},children:Object(g.jsx)(P.a,{textAlign:"center",variant:"h4",children:"Ordini"})}),n.length?Object(g.jsx)(se,{ordini:n,user:c,marcaOrdineCompletato:o}):Object(g.jsxs)(P.a,{textAlign:"center",children:["Nessun ordine caricato, clicca su",Object(g.jsxs)("pre",{style:{display:"inline",margin:"0px 5px"},children:[" ","Crea nuovo ordine"]})," ","per crearne uno"]})]})};var de=function(){var e=Object(a.a)("(prefers-color-scheme: dark)"),t=Object(i.useMemo)((function(){return Object(s.a)({palette:{type:e?"dark":"light",mode:e?"dark":"light",primary:{main:ae.a[500]},secondary:{main:"#f44336"},backgroundColor:"#20252c"}})}),[e]);return Object(g.jsx)("div",{children:Object(g.jsxs)(l.a,{theme:t,children:[Object(g.jsx)(d.a,{}),Object(g.jsx)(C,{children:Object(g.jsxs)(T,{children:[Object(g.jsx)(k,{}),Object(g.jsx)(ie,{children:Object(g.jsx)(le,{})})]})})]})})},je=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ue(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var be=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,205)).then((function(t){var n=t.getCLS,i=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),i(e),r(e),c(e),o(e)}))};o.a.render(Object(g.jsx)(r.a.StrictMode,{children:Object(g.jsx)(b.a,{domain:"davidevitiello-prove.eu.auth0.com",clientId:"pdE0j7PT8cHJBE7OTsqsHef3sZWshOKc",redirectUri:window.location.origin,children:Object(g.jsx)(de,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");je?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var i=n.headers.get("content-type");404===n.status||null!=i&&-1===i.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ue(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):ue(t,e)}))}}(),be()}},[[140,1,2]]]);
//# sourceMappingURL=main.e3e3a336.chunk.js.map